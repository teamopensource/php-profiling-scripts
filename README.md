php-profiler-scripts
====================

Scripts for automated conversion and visualization of profiling data on PHP function specific level.

The purpose of this collection of scripts is to visualize bulk data created by the xdebug profiler. Existing applications (such as kcachegrind) only visualizes one or more requests in a snapshot-fashion, we want to visualize a series of these snapshot. This way we are able to detect performance bottlenecks when dealing with multiple simultanous requests.

The repository consists of multiple small independent scripts. These can all be used separately if one wish to only convert data (without visualization) or visualize already converted data. But one can make a full conversion and visualization by utilizing the `run.py` script found in the root folder.

### Dependencies

The scripts have been developed on Debian 7.2 and uses

* Python 2.7.3
* R 2.15.1

The `run.py` script uses the Rscript command.

### Flow

You will need one or more cachegrind files (generated by xdebug). To illustrate the flow:

xdebug profiler > generates cachegrind files per request > **conversion from cachegrind to csv (Python)** > **visualization of csv (R)**

(two last steps are highlighted, because this is where the code in this repository is actually doing some work)

### Usage

Example usage:

    python run.py --i "input dir" --o "output dir" --cap 1000 --type "accumulation"

Parameters:

    --i (default ".")
    Directory containing the raw cachegrind files (expects files to be named like "cachegrind.*"
    
    --o (default ".")
    Directory to output the SVG file to (defaults to --i)
    
    --cap (default 0)
    Excludes function call profilings beneath a given number in microseconds (1000 = 0.1ms, 10000 = 1ms)
    
    --type (default "accumulation")
    Type of diagram that we desire to generate
    
### Notes

Be aware, that the visualization of the diagrams can take solid amounts of time (a couple of minutes if a threshold is not given, e.g. 25000 (2.5 ms))